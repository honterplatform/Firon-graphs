<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Share Of Voice</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #1a1a2e;
    font-family: system-ui, -apple-system, sans-serif;
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
  }
  .card {
    background: #16162a;
    border-radius: 16px;
    padding: 32px;
    width: 100%;
    max-width: 600px;
  }
  .title {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 32px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .info-icon {
    width: 20px; height: 20px;
    background: #444;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    color: #999;
  }
  .chart-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 40px;
  }
  canvas { display: block; }
  .legend {
    display: flex;
    flex-direction: column;
    gap: 14px;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 15px;
    opacity: 0;
    transform: translateX(10px);
    transition: opacity 0.4s ease, transform 0.4s ease;
  }
  .legend-item.visible {
    opacity: 1;
    transform: translateX(0);
  }
  .legend-color {
    width: 14px; height: 14px;
    border-radius: 3px;
    flex-shrink: 0;
  }
</style>
</head>
<body>
<div class="card">
  <div class="title">Share Of Voice <span class="info-icon">i</span></div>
  <div class="chart-container">
    <canvas id="donut" width="260" height="260"></canvas>
    <div class="legend" id="legend"></div>
  </div>
</div>
<script>
const data = [
  { label: 'target.com', value: 30, color: '#9B6DB5' },
  { label: 'magneticme.com', value: 25, color: '#5CC8C8' },
  { label: 'primary.com', value: 22, color: '#F5B858' },
  { label: 'stitchfix.com', value: 13, color: '#58C878' },
  { label: 'kohls.com', value: 10, color: '#E8845A' },
];

const canvas = document.getElementById('donut');
const ctx = canvas.getContext('2d');
const dpr = window.devicePixelRatio || 1;
canvas.width = 260 * dpr;
canvas.height = 260 * dpr;
canvas.style.width = '260px';
canvas.style.height = '260px';
ctx.scale(dpr, dpr);

const cx = 130, cy = 130, outerR = 115, innerR = 70;
const total = data.reduce((s, d) => s + d.value, 0);

// Build legend
const legendEl = document.getElementById('legend');
data.forEach(d => {
  const item = document.createElement('div');
  item.className = 'legend-item';
  item.innerHTML = `<div class="legend-color" style="background:${d.color}"></div>${d.label}`;
  legendEl.appendChild(item);
});

function easeOutCubic(t) { return 1 - Math.pow(1 - t, 3); }

const duration = 1500;
let start = null;

function draw(timestamp) {
  if (!start) start = timestamp;
  const elapsed = timestamp - start;
  const progress = Math.min(elapsed / duration, 1);
  const easedProgress = easeOutCubic(progress);
  const maxAngle = easedProgress * Math.PI * 2;

  ctx.clearRect(0, 0, 260, 260);

  let currentAngle = -Math.PI / 2;
  for (const d of data) {
    const sliceAngle = (d.value / total) * Math.PI * 2;
    const drawAngle = Math.min(sliceAngle, Math.max(0, maxAngle - (currentAngle + Math.PI / 2)));
    if (drawAngle > 0) {
      ctx.beginPath();
      ctx.arc(cx, cy, outerR, currentAngle, currentAngle + drawAngle);
      ctx.arc(cx, cy, innerR, currentAngle + drawAngle, currentAngle, true);
      ctx.closePath();
      ctx.fillStyle = d.color;
      ctx.fill();
    }
    currentAngle += sliceAngle;
  }

  if (progress < 1) {
    requestAnimationFrame(draw);
  } else {
    // Animate legend items
    const items = document.querySelectorAll('.legend-item');
    items.forEach((item, i) => {
      setTimeout(() => item.classList.add('visible'), i * 120);
    });
  }
}

requestAnimationFrame(draw);
</script>
</body>
</html>
